import urllib
import mechanize


import cookielib

# Browser
br = mechanize.Browser()

# Cookie Jar
cj = cookielib.LWPCookieJar()
br.set_cookiejar(cj)

# Browser options
br.set_handle_equiv(True)
br.set_handle_gzip(True)
br.set_handle_redirect(True)
br.set_handle_referer(True)
br.set_handle_robots(False)

# Follows refresh 0 but not hangs on refresh > 0
br.set_handle_refresh(mechanize._http.HTTPRefreshProcessor(), max_time=1)

# Want debugging messages?
#br.set_debug_http(True)
#br.set_debug_redirects(True)
#br.set_debug_responses(True)

# User-Agent (this is cheating, ok?)
br.addheaders = [('User-agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1')]

tableofcontents_url = "http://www.amlegal.com/nxt/gateway.dll/California/administrative/chapter1generalprovisions?f=templates$fn=altmain-nf-contents.htm$3.0&tt=altmain-nf.htm&t=altmain-nf-contents.htm&tf=_self&global=hitdoc_g_&hitdoc_g_dt=altmain-nf.htm"

landing_url= "http://www.amlegal.com/nxt/gateway.dll?f=templates&fn=default.htm&vid=amlegal:sanfrancisco_ca"

br.open(landing_url)
#r = br.open(tableofcontents_url)
#html = r.read()

# Show the source
#print html

form_submit_url = "http://www.amlegal.com/alpscripts/get-content.aspx"

data1 = {
"format":"html",
"cmd":"save",
"domain":"California/administrative(administrativecode,chapter1generalprovisions,chapter2boardofsupervisors,chapter2aexecutivebranch,chapter2bassessmentappealsboardstaxappea,chapter3budgetprocedures,chapter4citybuildingsequipmentandvehicle,chapter5committees,chapter6publicworkscontractingpoliciesan,chapter7disastercouncil,chapter8documentsrecordsandpublications,chapter9afarmersmarket,chapter9bfleamarket,chapter10financetaxationandotherfiscalma,chapter10bspeciallawenforcementandpublic,chapter10creimbursementfortowingandstora,chapter10eplanningmonitoring,chapter10f1660missionstreetsurcharge,chapter10gboardofappealssurchargeforperm,chapter10hrecoveryofcostsofemergencyresp,chapter11franchises,chapter12housingauthority,chapter12ahumanrightscommission,chapter12bnondiscriminationincontracts,chapter12cnondiscriminationinpropertycon,chapter12dminoritywomenlocalbusinessutil,chapter12ecityemployeessexualprivacyordi,chapter12fimplementingthemacbrideprincip,chapter12gprohibitiononuseofpublicfundsf,chapter12himmigrationstatus,chapter12jcitybusinesswithburmaprohibite,chapter12klocalimplementationoftheunited,chapter12lpublicaccesstorecordsandmeetin,chapter12mprotectionofprivateinformation,chapter12nlesbiangaybisexualtransgenderq,chapter12oearnedincomecreditinformation,chapter12pminimumcompensation,chapter12qhealthcareaccountability,chapter12rminimumwage,chapter12sworkingfamiliescreditprogram,chapter12usweatfreecontracting,chapter12vpersonalservicesminimumcontrac,chapter12wsickleave*,chapter12xpolicymakingmarijuanaoffensest,chapter12ysanfranciscoslaverydisclosureo,chapter13jailsandprisoners,chapter14sanfranciscohealthcaresecurityo,chapter14adisadvantagedbusinessenterpris,chapter14blocalbusinessenterpriseandnon-,chapter14ccaliforniabenefitcorporationdi,chapter15mentalhealthservice,chapter16officersandemployeesgenerally,chapter17publicoff-streetparkingfaciliti,chapter18payrollprocedure,chapter19communitysafetycameraordinance,chapter19apublichealth,chapter20socialservices,chapter21acquisitionofcommoditiesandserv,chapter21cmiscellaneousprevailingwagereq,chapter22radiocommunicationfacilities,chapter22ainformationandcommunicationtec,chapter22btelecommunicationsfacilities,chapter22cpublicinternetaccess,chapter22dopendatapolicy,chapter23realpropertytransactions,chapter23asurpluscitypropertyordinance,chapter24redevelopmentagency,chapter24aadministrativestructurelocalre,chapter24brelocationappealsboard,chapter25streetlighting,chapter26deemedapprovedoff-streetalcohol,chapter27healthynailsalonrecognitionprog,chapter28administrativedebarmentprocedur,chapter29findingsoffiscalresponsibilitya,chapter29aapprovalofpowerplantplanningco,chapter29bchildcarefeasibilitystudyforci,chapter30centralizationofworkforcedevelo,chapter31californiaenvironmentalqualitya,chapter32residentialrehabilitationloanpr,chapter33commissiononthestatusofwomen,chapter34notificationtoassessorconcernin,chapter35residentialandindustrialcompati,chapter36communityimprovementsareaplansa,chapter37residentialrentstabilizationand,chapter37arentstabilizationandarbitratio,chapter38commerciallandlordsaccessimprov,chapter39righttoreturntorevitalizedpubli,chapter40housingcodeenforcementloanprogr)",
"domain_paths":"California/administrative/administrativecode/,California/administrative/chapter1generalprovisions/,California/administrative/chapter2boardofsupervisors/,California/administrative/chapter2aexecutivebranch/,California/administrative/chapter2bassessmentappealsboardstaxappea/,California/administrative/chapter3budgetprocedures/,California/administrative/chapter4citybuildingsequipmentandvehicle/,California/administrative/chapter5committees/,California/administrative/chapter6publicworkscontractingpoliciesan/,California/administrative/chapter7disastercouncil/,California/administrative/chapter8documentsrecordsandpublications/,California/administrative/chapter9afarmersmarket/,California/administrative/chapter9bfleamarket/,California/administrative/chapter10financetaxationandotherfiscalma/,California/administrative/chapter10bspeciallawenforcementandpublic/,California/administrative/chapter10creimbursementfortowingandstora/,California/administrative/chapter10eplanningmonitoring/,California/administrative/chapter10f1660missionstreetsurcharge/,California/administrative/chapter10gboardofappealssurchargeforperm/,California/administrative/chapter10hrecoveryofcostsofemergencyresp/,California/administrative/chapter11franchises/,California/administrative/chapter12housingauthority/,California/administrative/chapter12ahumanrightscommission/,California/administrative/chapter12bnondiscriminationincontracts/,California/administrative/chapter12cnondiscriminationinpropertycon/,California/administrative/chapter12dminoritywomenlocalbusinessutil/,California/administrative/chapter12ecityemployeessexualprivacyordi/,California/administrative/chapter12fimplementingthemacbrideprincip/,California/administrative/chapter12gprohibitiononuseofpublicfundsf/,California/administrative/chapter12himmigrationstatus/,California/administrative/chapter12jcitybusinesswithburmaprohibite/,California/administrative/chapter12klocalimplementationoftheunited/,California/administrative/chapter12lpublicaccesstorecordsandmeetin/,California/administrative/chapter12mprotectionofprivateinformation/,California/administrative/chapter12nlesbiangaybisexualtransgenderq/,California/administrative/chapter12oearnedincomecreditinformation/,California/administrative/chapter12pminimumcompensation/,California/administrative/chapter12qhealthcareaccountability/,California/administrative/chapter12rminimumwage/,California/administrative/chapter12sworkingfamiliescreditprogram/,California/administrative/chapter12usweatfreecontracting/,California/administrative/chapter12vpersonalservicesminimumcontrac/,California/administrative/chapter12wsickleave*/,California/administrative/chapter12xpolicymakingmarijuanaoffensest/,California/administrative/chapter12ysanfranciscoslaverydisclosureo/,California/administrative/chapter13jailsandprisoners/,California/administrative/chapter14sanfranciscohealthcaresecurityo/,California/administrative/chapter14adisadvantagedbusinessenterpris/,California/administrative/chapter14blocalbusinessenterpriseandnon-/,California/administrative/chapter14ccaliforniabenefitcorporationdi/,California/administrative/chapter15mentalhealthservice/,California/administrative/chapter16officersandemployeesgenerally/,California/administrative/chapter17publicoff-streetparkingfaciliti/,California/administrative/chapter18payrollprocedure/,California/administrative/chapter19communitysafetycameraordinance/,California/administrative/chapter19apublichealth/,California/administrative/chapter20socialservices/,California/administrative/chapter21acquisitionofcommoditiesandserv/,California/administrative/chapter21cmiscellaneousprevailingwagereq/,California/administrative/chapter22radiocommunicationfacilities/,California/administrative/chapter22ainformationandcommunicationtec/,California/administrative/chapter22btelecommunicationsfacilities/,California/administrative/chapter22cpublicinternetaccess/,California/administrative/chapter22dopendatapolicy/,California/administrative/chapter23realpropertytransactions/,California/administrative/chapter23asurpluscitypropertyordinance/,California/administrative/chapter24redevelopmentagency/,California/administrative/chapter24aadministrativestructurelocalre/,California/administrative/chapter24brelocationappealsboard/,California/administrative/chapter25streetlighting/,California/administrative/chapter26deemedapprovedoff-streetalcohol/,California/administrative/chapter27healthynailsalonrecognitionprog/,California/administrative/chapter28administrativedebarmentprocedur/,California/administrative/chapter29findingsoffiscalresponsibilitya/,California/administrative/chapter29aapprovalofpowerplantplanningco/,California/administrative/chapter29bchildcarefeasibilitystudyforci/,California/administrative/chapter30centralizationofworkforcedevelo/,California/administrative/chapter31californiaenvironmentalqualitya/,California/administrative/chapter32residentialrehabilitationloanpr/,California/administrative/chapter33commissiononthestatusofwomen/,California/administrative/chapter34notificationtoassessorconcernin/,California/administrative/chapter35residentialandindustrialcompati/,California/administrative/chapter36communityimprovementsareaplansa/,California/administrative/chapter37residentialrentstabilizationand/,California/administrative/chapter37arentstabilizationandarbitratio/,California/administrative/chapter38commerciallandlordsaccessimprov/,California/administrative/chapter39righttoreturntorevitalizedpubli/,California/administrative/chapter40housingcodeenforcementloanprogr/"}

data2 = {
"format":"html",
"cmd":"save",
"domain":"California/administrative(chapter41residentialhotelunitconversiona,chapter41aresidentialunitconversionandde,chapter41ctime-shareconversionordinance,chapter41dresidentialhotelvisitorpolicie,chapter41eresidentialhotelmailreceptacle,chapter41ftouristhotelconversion*,chapter42industrialdevelopmentauthority,chapter43municipalfinancelaw,chapter44adultdayhealthcareplanningcounc,chapter45juryfees,chapter48rentalsubsidyprogramforlow-inco,chapter49securitydepositsforresidentialr,chapter49aresidentialtenantcommunication,chapter49bresidentialrentalunitslockrepl,chapter50nonprofitperformingartsloanprog,chapter51voluntaryartscontributionsprogr,chapter52sanfranciscocarbonmitigationpro,chapter53urbanagriculture,chapter54southeastcommunityfacilitycommi,chapter56developmentagreements,chapter57filmcommission,chapter58righttocounselincivilmatters,chapter60assistedhousingpreservationordi,chapter61waterfrontlanduse,chapter62domesticpartnerships,chapter63waterefficientirrigationordinan,chapter64cityemployeeandcitycontractorsa,chapter65rentreductionandrelocationplanf,chapter66seismicsafetyretrofitprogram,chapter66aseismicsafetyloanprogram,chapter67thesanfranciscosunshineordinanc,chapter67acellphonespagersandsimilarsoun,chapter68culturalequityendowmentfund,chapter69sanfranciscohealthauthority,chapter70in-homesupportiveservicespublic,chapter71millsactcontractprocedures,chapter72relocationassistanceforleadhaza,chapter74rentescrowaccountprogram,chapter77buildinginspectioncommissionapp,chapter78departmentofbuildinginspectionp,chapter79preapprovalnoticeforcertaincity,chapter79aadditionalpreapprovalnoticefor,chapter80anti-blightenforcementprocedure,chapter83firstsourcehiringprogram,chapter84sanfranciscoresidentialrentassi,chapter86childrenandfamiliesfirstcommiss,chapter87fairhousingimplementationordina,chapter88performanceandreviewordinanceof,chapter89departmentofchildsupportservice,chapter90entertainmentcommission,chapter90apromotingandsustainingmusicand,chapter91languageaccess,chapter92realestateloancounselingandeduc,chapter93pregnancyinformationdisclosurea,chapter95identificationcards,chapter96coordinationbetweenthepolicedep,chapter97healthcareimpactreports,chapter98thebetterstreetspolicy,chapter99publicpowerinnewcitydevelopment,chapter100proceduresgoverningtheimpositi,chapter105cigarettelitterabatementfeeord,chapter115automatedpointofsalestationreg,appendicesinitiativeordinances,referencestoordinances)",
"domain_paths":"California/administrative/chapter41residentialhotelunitconversiona/,California/administrative/chapter41aresidentialunitconversionandde/,California/administrative/chapter41ctime-shareconversionordinance/,California/administrative/chapter41dresidentialhotelvisitorpolicie/,California/administrative/chapter41eresidentialhotelmailreceptacle/,California/administrative/chapter41ftouristhotelconversion*/,California/administrative/chapter42industrialdevelopmentauthority/,California/administrative/chapter43municipalfinancelaw/,California/administrative/chapter44adultdayhealthcareplanningcounc/,California/administrative/chapter45juryfees/,California/administrative/chapter48rentalsubsidyprogramforlow-inco/,California/administrative/chapter49securitydepositsforresidentialr/,California/administrative/chapter49aresidentialtenantcommunication/,California/administrative/chapter49bresidentialrentalunitslockrepl/,California/administrative/chapter50nonprofitperformingartsloanprog/,California/administrative/chapter51voluntaryartscontributionsprogr/,California/administrative/chapter52sanfranciscocarbonmitigationpro/,California/administrative/chapter53urbanagriculture/,California/administrative/chapter54southeastcommunityfacilitycommi/,California/administrative/chapter56developmentagreements/,California/administrative/chapter57filmcommission/,California/administrative/chapter58righttocounselincivilmatters/,California/administrative/chapter60assistedhousingpreservationordi/,California/administrative/chapter61waterfrontlanduse/,California/administrative/chapter62domesticpartnerships/,California/administrative/chapter63waterefficientirrigationordinan/,California/administrative/chapter64cityemployeeandcitycontractorsa/,California/administrative/chapter65rentreductionandrelocationplanf/,California/administrative/chapter66seismicsafetyretrofitprogram/,California/administrative/chapter66aseismicsafetyloanprogram/,California/administrative/chapter67thesanfranciscosunshineordinanc/,California/administrative/chapter67acellphonespagersandsimilarsoun/,California/administrative/chapter68culturalequityendowmentfund/,California/administrative/chapter69sanfranciscohealthauthority/,California/administrative/chapter70in-homesupportiveservicespublic/,California/administrative/chapter71millsactcontractprocedures/,California/administrative/chapter72relocationassistanceforleadhaza/,California/administrative/chapter74rentescrowaccountprogram/,California/administrative/chapter77buildinginspectioncommissionapp/,California/administrative/chapter78departmentofbuildinginspectionp/,California/administrative/chapter79preapprovalnoticeforcertaincity/,California/administrative/chapter79aadditionalpreapprovalnoticefor/,California/administrative/chapter80anti-blightenforcementprocedure/,California/administrative/chapter83firstsourcehiringprogram/,California/administrative/chapter84sanfranciscoresidentialrentassi/,California/administrative/chapter86childrenandfamiliesfirstcommiss/,California/administrative/chapter87fairhousingimplementationordina/,California/administrative/chapter88performanceandreviewordinanceof/,California/administrative/chapter89departmentofchildsupportservice/,California/administrative/chapter90entertainmentcommission/,California/administrative/chapter90apromotingandsustainingmusicand/,California/administrative/chapter91languageaccess/,California/administrative/chapter92realestateloancounselingandeduc/,California/administrative/chapter93pregnancyinformationdisclosurea/,California/administrative/chapter95identificationcards/,California/administrative/chapter96coordinationbetweenthepolicedep/,California/administrative/chapter97healthcareimpactreports/,California/administrative/chapter98thebetterstreetspolicy/,California/administrative/chapter99publicpowerinnewcitydevelopment/,California/administrative/chapter100proceduresgoverningtheimpositi/,California/administrative/chapter105cigarettelitterabatementfeeord/,California/administrative/chapter115automatedpointofsalestationreg/,California/administrative/appendicesinitiativeordinances/,California/administrative/referencestoordinances/"}


r = br.open(form_submit_url, urllib.urlencode(data1))
print r.read()

r = br.open(form_submit_url, urllib.urlencode(data2))
print r.read()






#page = urllib2.urlopen(url)
#print page.read()

print "Hello World"
